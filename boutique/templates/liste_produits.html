{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">Liste des produits</h1>

    <!-- Formulaire de recherche -->
    <form method="get" action="{% url 'gestion:rechercher_produit' %}" class="mb-3">
        <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Rechercher un produit...">
            <div class="input-group-append">
                <button type="submit" class="btn btn-secondary"><i class="fas fa-search"></i></button>
            </div>
        </div>
    </form>

    <a href="{% url 'gestion:ajouter_produit' %}" class="btn btn-primary mb-3"><i class="fas fa-plus"></i></a>
    <a href="{% url 'gestion:gestion_categories' %}" class="btn btn-info mb-3"><i class="fas fa-tags"></i></a> <!-- Lien vers la gestion des catégories -->

    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Image</th>
                <th>Nom</th>
                <th>Catégorie</th>
                <th>Quantité</th>
                <th>Prix</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for produit in produits %}
            <tr>
                <td>
                    {% if produit.image %}
                        <img src="{{ produit.image.url }}" alt="{{ produit.nom }}" width="50">
                    {% else %}
                        Pas d'image
                    {% endif %}
                </td>
                <td>{{ produit.nom }}</td>
                <td>{{ produit.categories.all|join:", " }}</td>
                <td>{{ produit.quantite }}</td>
                <td>{{ produit.prix }} FCFA</td>
                <td>
                    <a href="{% url 'gestion:modifier_produit' produit.id %}" class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></a>
                    <a href="{% url 'gestion:supprimer_produit' produit.id %}" class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></a>
                    <a href="{% url 'gestion:effectuer_vente' produit.id %}" class="btn btn-sm btn-success"><i class="fas fa-shopping-cart"></i></a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
